<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>UTF-8 support for CodeIgniter | Phil Sturgeon</title>
  <meta name="description" content="I used to contribute to the PHP-FIG, The League of Extraordinary Packages, PHP The Right Way, CodeIgniter, FuelPHP, PyroCMS and a bunch of other stuff, but I gave it all up to join the circus" />

  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <link rel="shortcut icon" href="/assets/images/favicon.ico">
  <link rel="stylesheet" href="//brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  <link href="/stylesheets/main.css" rel="stylesheet" media="screen" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />

  <meta property="og:name" content="Phil Sturgeon">
  <meta property="og:image" content="/images/author.jpg">
  <meta property="og:description" content="Writing an application is easy. Writing an application that supports all characters from multiple languages? Not so easy.">
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@philsturgeon">
  <meta name="twitter:title" content="UTF-8 support for CodeIgniter | Phil Sturgeon">
  <meta name="twitter:creator" content="@philsturgeon">
  <meta name="twitter:image:src" content="/images/author.jpg">
  <meta name="twitter:description" content="Writing an application is easy. Writing an application that supports all characters from multiple languages? Not so easy.">
  
  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
</head>


  <body>

    <a class='fa fa-home logo-readium' href='/'></a>


    <!-- content start -->

    <main class="content" role="main">
      <article class="post">
        <div class="noarticleimage">
          <div class="post-meta">
            <h1 class="post-title">UTF-8 support for CodeIgniter</h1>
            <div class="cf post-meta-text">
              <div class="author-image" style="background-image: url(/images/author.jpg)">Blog Logo</div>
              <h4 class="author-name" itemprop="author" itemscope itemtype="http://schema.org/Person">Phil Sturgeon</h4>
              on
              <time datetime="2009-08-17 15:05:00 UTC">
                Aug 17 2009
              </time>
            </div>
          </div>
        </div>
        <br>
        <br>
        <br>
        <section class="post-content">
          <div class="post-reading">
            <span class="post-reading-time"></span> read
          </div>
          <a name="topofpage"></a>
          <p>Writing an application is easy. Writing an application that supports all characters from multiple languages? Not so easy.</p>

<p>The main problem comes from way back, when the main language in computing was English. The ASCII characters were given numbers from 1 to 128 a-z, A-Z, 0-9 and punctuation. That is fine for the English language but pretty much every other language out there has characters that don’t fit in there. To address this, we have UTF-8, which can store extra characters as multiple-bits and is backwards compatible with ASCII.</p>

<p>To make your <a title="CodeIgniter - PHP MVC Framework" href="http://codeigniter.com/">CodeIgniter</a> application play nicely with UTF-8 you have a few things to think about.</p>

<h3 id="set-the-http-header-in-indexphp">Set the HTTP header in index.php</h3>

<p>All requests to CodeIgniter are made through the index.php file which by default sits outside the system/ folder. For this reason it makes a perfect place to add a PHP header for me.</p>

<p><code>header('Content-Type: text/html; charset=utf-8');</code></p>

<h3 id="tell-codeigniter-whats-going-on">Tell CodeIgniter what’s going on</h3>

<p>CodeIgniter by default is set to use UTF-8 for much of its internal functionality, so just make sure the charset is set to UTF-8 in your <strong>application/config/config.php</strong> file.</p>

<p><code> $config['charset'] = "UTF-8"; </code></p>

<h3 id="configure-database-connection">Configure database connection</h3>

<p><code> $db['default']['char_set'] = "utf8"; $db['default']['dbcollat'] = "utf8_unicode_ci"; </code></p>

<p>The default here is normally utf8_general_ci which is a pretty weak for of Unicode. This is a quote from <a href="http://stackoverflow.com/questions/1036454/what-are-the-diffrences-between-utf8generalci-and-utf8unicodeci">StackOverflow</a> which I think explains things pretty well.</p>

<blockquote>
  <p>“utf8_unicode_ci is generally more accurate for all scripts. For example, on Cyrillic block: utf8_unicode_ci is fine for all these languages: Russian, Bulgarian, Belarusian, Macedonian, Serbian, and Ukrainian. While utf8_general_ci is fine only for Russian and Bulgarian subset of Cyrillic. Extra letters used in Belarusian, Macedonian, Serbian, and Ukrainian are sorted not well.”
### Set up or convert your MySQL</p>
</blockquote>

<p>To get this working you need to use MySQL 4.1 (or higher) with utf8 support enabled, but this is pretty standard for most web-hosts.</p>

<p><code> CREATE DATABASE example     CHARACTER SET utf8     DEFAULT CHARACTER SET utf8     COLLATE utf8_unicode_ci     DEFAULT COLLATE utf8_unicode_ci; </code></p>

<p>If you already have the database set up and running, you can use the following code to convert the database to use UTF-8.</p>

<p><code> ALTER DATABASE example    CHARACTER SET utf8    DEFAULT CHARACTER SET utf8    COLLATE utf8_unicode_ci    DEFAULT COLLATE utf8_unicode_ci; </code></p>

<p>Now the database is ready, you need to add in some tables.</p>

<p><code> CREATE TABLE blog (    id INT(11) UNSIGNED NOT NULL AUTO_INCREMENT,    title VARCHAR(100) COLLATE utf8_unicode_ci NOT NULL DEFAULT '',    body TEXT COLLATE utf8_unicode_ci NOT NULL DEFAULT '',) DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; </code> As with the database, if your tables already exist then you can use the following code to convert your data. You might get some fairly strange results if it is full of data in another non-English character set, but on the whole this has never been an issue for me. ` ALTER TABLE blog (    id INT(11) UNSIGNED NOT NULL AUTO_INCREMENT,    title VARCHAR(100) COLLATE utf8_unicode_ci NOT NULL DEFAULT ‘’,    body TEXT COLLATE utf8_unicode_ci NOT NULL DEFAULT ‘’,) DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; `</p>

<h3 id="and-finally-set-up-your-meta-data">And finally, set up your Meta Data.</h3>

<p>he last place to set for UTF-8 support is in your HTML in the &lt;head&gt; tag. You can use CodeIgniter’s meta() function in the <a title="CodeIgniter User Guide: HTML Helper" href="http://codeigniter.com/user_guide/helpers/html_helper.html">HTML helper</a> or plain HTML. ` &lt;html&gt;   &lt;head&gt;     <?php echo meta('Content-type', 'text/html; charset='.config_item('charset'), 'equiv');?>     <!-- or -->     <meta http-equiv="content-type" content="text/html; charset=&lt;?php echo config_item('charset');?&gt;" />   &lt;/head&gt; `</p>

<p>I have used the config item instead of just putting in UTF-8 as it makes more sense from a programming point of view. If for any reason your charset is changed in the future, that is one less place to change it.</p>

<p>Now your CodeIgniter application is ready, you need to make sure your database GUI is too. I regularly use Navicat and phpMyAdmin and on both you can set the “MySQL connection collation”, so make sure that is set to “utf8_unicode_ci” too or it could show characters wrong and will most likely corrupt your data as you work on it.</p>

<p>For more help developing with UTF-8, take a look at “ <a href="http://www.phpwact.org/php/i18n/utf-8">Handling UTF-8 with PHP</a>” which will explain some of the problems of using the normal string functions on UTF-8 strings, then take a look at PHP’s “ <a href="http://uk3.php.net/manual/en/ref.mbstring.php">Multibyte String Functions</a>” manual pages to learn how to handle your new happily stored UTF-8 data.</p>


        </section>
        <footer class="post-footer">
            <section class="share">
                  <a class="icon-twitter" href="https://twitter.com/share?text=UTF-8 support for CodeIgniter&amp;url=https://philsturgeon.uk/codeigniter/2009/08/17/UTF-8-support-for-CodeIgniter/"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
                  <i class="fa fa-twitter"></i><span class="hidden">twitter</span>
                  </a>
                  <a class="icon-facebook" href="https://www.facebook.com/sharer.php?t=UTF-8 support for CodeIgniter&amp;u=https://philsturgeon.uk/codeigniter/2009/08/17/UTF-8-support-for-CodeIgniter/"
                    onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
                  <i class="fa fa-facebook"></i><span class="hidden">facebook</span>
                  </a>
            </section>
            <section class="post-next-previous">
                <p>
                    Previous:
                    <a class="button" href="/php/2009/07/28/How-to-Create-a-Twitter-feed-with-full-syntax-support/">How to: Create a Twitter feed with full syntax support</a>
                </p>
                <p style="float:right">
                    Next: 
                    <a class="button" href="/codeigniter/2009/08/27/Clearing-CodeIgniter-session-data/">Clearing CodeIgniter session data</a>
                </p>
            </section>
        </footer>
        <div class="bottom-teaser cf">
          <div class="isLeft">
            <h5 class="index-headline featured"><span>Written by</span></h5>
            <section class="author">
              <div class="author-image" style="background-image: url(/images/author.jpg)">Blog Logo</div>
              <h4>Phil Sturgeon</h4>
              <p class="bio">Phil has contributed to CodeIgniter, FuelPHP, Laravel and handfuls of other projects, to try and make the PHP community a better place.</p>
              <hr>
              <p class="published">Published <time datetime="2009-08-17 15:05:00 UTC">2009-08-17 15:05:00 UTC</time></p>
            </section>
          </div>
          <div class="isRight">
            <h5 class="index-headline featured"><span>More Writing</span></h5>
            <footer class="site-footer">
              <h4>Build APIs You Won't Hate</h4>
              <p>Everyone and their dog wants an API, so you should probably learn how to build them.</p>
              <p><a href="http://apisyouwonthate.com/">Buy it from LeanPub or Amazon</a></p>
              <hr>
              <p class="published">Published 01 Feb 2014</p>
            </footer>
          </div>
        </div>
      </article>


    </main>
    <div class="bottom-closer">
      <div class="background-closer-image" style="background-image: url(/images/ciderphpants.jpg)">
        Image
      </div>
      <div class="inner">
        <h1 class="blog-title">Phil Sturgeon</h1>
        <h2 class="blog-description">I used to contribute to the PHP-FIG, The League of Extraordinary Packages, PHP The Right Way, CodeIgniter, FuelPHP, PyroCMS and a bunch of other stuff, but I gave it all up to join the circus</h2>
        <a href="/" class="btn">Back to Overview</a>
      </div>
    </div>

    <!-- content end -->

    <footer class='footer' role='contentinfo'>
  <div class='footer-links'>
    <ul class='context'>
      <li>
        <h3>Content</h3>
      </li>
      <li>
        <a href='/about'>About</a>
      </li>
      <li>
        <a href='/books'>Books</a>
      </li>
    </ul>
    <ul class='follow'>
      <li>
        <h3>Follow Me</h3>
      </li>
      <li>
        <a href='https://twitter.com/philsturgeon'>Twitter</a>
      </li>
      <li>
        <a href='https://github.com/'>GitHub</a>
      </li>
      <li>
        <a href='http://phptownhall.com/'>PHP Town Hall</a>
      </li>
    </ul>
    <ul class='recent_posts'>
      <li>
        <h3>Recent Posts</h3>
        <ul>
          <li><a href="/http/2015/09/03/auto-incrementing-to-destruction/">Auto-Incrementing IDs: Giving your Data Away</a></li>
          <li><a href="/charity/2015/08/20/no-booze/">No Booze for a Month</a></li>
          <li><a href="/feminism/2015/08/17/women-speaker-ratio-conversation-loop/">The Ratio of Women Speakers in Tech</a></li>
        </ul>
      </li>
    </ul>
  </div>
</footer>

    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="/javascripts/jquery.fitvids.js"></script>
<script src="/javascripts/index.js"></script>
<script src="/javascripts/readingTime.min.js"></script>
<script>
(function ($) {
  "use strict";
  $(document).ready(function(){

    var $window = $(window),
    $image = $('.post-image-image, .teaserimage-image');
    $window.on('scroll', function() {
      var top = $window.scrollTop();

      if (top < 0 || top > 1500) { return; }
      $image
        .css('transform', 'translate3d(0px, '+top/3+'px, 0px)')
        .css('opacity', 1-Math.max(top/700, 0));
    });
    $window.trigger('scroll');

    var height = $('.article-image').height();
    $('.post-content').css('padding-top', height + 'px');

    $('a[href*=#]:not([href=#])').click(function() {
      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'')
       && location.hostname == this.hostname) {
        var target = $(this.hash);
        target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
        if (target.length) {
          $('html,body').animate({ scrollTop: target.offset().top }, 500);
          return false;
        }
      }
    });
  });
}(jQuery));
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8523256-1', 'auto');
  ga('send', 'pageview');

</script>


  </body>

</html>
