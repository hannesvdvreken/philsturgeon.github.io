<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Managing CodeIgniter Packages with Git Submodules | Phil Sturgeon</title>
  <meta name="description" content="I used to contribute to the PHP-FIG, The League of Extraordinary Packages, PHP The Right Way, CodeIgniter, FuelPHP, PyroCMS and a bunch of other stuff, but I gave it all up to join the circus" />

  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <link rel="stylesheet" href="//brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  <link href="/stylesheets/main.css" rel="stylesheet" media="screen" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href="/images/favicon.png" rel="icon" type="image/png" />

  <meta property="og:title" content="Managing CodeIgniter Packages with Git Submodules" />
  <meta property="og:type" content="article" />
  <meta property="article:author" content="Phil Sturgeon" />
  <meta property="og:description" content="With CodeIgniter moving to GitHub we are starting to see a lot of CodeIgniter developers wanting to learn more about Git, specifically how they can use it to improve their workflows, manage their applications and move away from the horrible days of copying and pasting updated libraries off a wiki. UCK. Sparks are helping us on the whole, but there is another method that we can use to manage our packages: Git Submodules. " />
  <meta property="og:site_name" content="Phil Sturgeon" />
  <meta property="og:image" content="https://philsturgeon.uk/images/author.jpg" />
  <meta property="og:url" content="https://philsturgeon.uk/codeigniter/2011/09/25/managing-codeigniter-packages-with-git-submodules/" />
  <meta property="og:locale" content="en_GB" />
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@philsturgeon">
  <meta name="twitter:title" content="Managing CodeIgniter Packages with Git Submodules | Phil Sturgeon">
  <meta name="twitter:image:src" content="https://philsturgeon.uk/images/author.jpg">
  <meta name="twitter:url" content="https://philsturgeon.uk/codeigniter/2011/09/25/managing-codeigniter-packages-with-git-submodules/">
  <meta name="twitter:description" content="With CodeIgniter moving to GitHub we are starting to see a lot of CodeIgniter developers wanting to learn more about Git, specifically how they can use it to improve their workflows, manage their applications and move away from the horrible days of copying and pasting updated libraries off a wiki. UCK. Sparks are helping us on the whole, but there is another method that we can use to manage our packages: Git Submodules. ">
  <meta name="twitter:creator" content="@philsturgeon">
  
  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
</head>


  <body>

    <a class='fa fa-home logo-readium' href='/'></a>


    <!-- content start -->

    <main class="content" role="main">
      <article class="post">
        <div class="noarticleimage">
          <div class="post-meta">
            <h1 class="post-title">Managing CodeIgniter Packages with Git Submodules</h1>
            <div class="cf post-meta-text">
              <div class="author-image" style="background-image: url(/images/author.jpg)">Blog Logo</div>
              <h4 class="author-name" itemprop="author" itemscope itemtype="http://schema.org/Person">Phil Sturgeon</h4>
              on
              <time datetime="2011-09-25 11:09:00 UTC">
                Sep 25 2011
              </time>
            </div>
          </div>
        </div>
        <br>
        <br>
        <br>
        <section class="post-content">
          <div class="post-reading">
            <span class="post-reading-time"></span> read
          </div>
          <a name="topofpage"></a>
          <p>With CodeIgniter moving to GitHub we are starting to see a lot of CodeIgniter developers wanting to learn more about Git, specifically how they can use it to improve their workflows, manage their applications and move away from the horrible days of copying and pasting updated libraries off a wiki. UCK. Sparks are helping us on the whole, but there is another method that we can use to manage our packages: Git <a href="http://book.git-scm.com/5_submodules.html">Submodules</a>.</p>

<p>For those who have not heard of submodules in Git, I’ll let the Git Book explain it:</p>

<blockquote>
  <p>Git’s submodule support allows a repository to contain, as a subdirectory, a
checkout of an external project. Submodules maintain their own identity;
the submodule support just stores the submodule repository location and
commit ID, so other developers who clone the containing project
(“superproject”) can easily clone all the submodules at the same revision.
Partial checkouts of the superproject are possible: you can tell Git to
clone none, some or all of the submodules.</p>
</blockquote>

<p>Great! So we can have our main application and other little packages can be installed as submodules which have their own repositories.</p>

<h3 id="why-bother">Why bother?</h3>

<p>It’s a good question. This all sounds like a lot of extra work but if like me you are working on 5 different applications at any one time you might have started to notice something:</p>

<p>In each project you work on your are probably creating libraries or packages that can be used in multiple places. For example I recently built the <a href="https://github.com/philsturgeon/codeigniter-oauth2">oauth2</a> package which I was using in two different applications. These were totally different applications for different clients on different servers and there was no way I could get away with symlinking, sharing folder structures, etc and I noticed that if i fixed a bug in one location I would have to copy it over to the other application. If I had 10 projects using the oauth2 package that would be a LOT of copying and pasting with huge potential for pooching the system.</p>

<p>Even if you are not in a situation where you need to copy between applications, you want to release your code to the world without having to copy it to a special “oauth2” folder which just contains those specific files. This is how I was releasing code for years: copy and paste. Bah!</p>

<p>Instead I created a new repo on GitHub for the oauth2 package, pushed my files in and set it up as a submodule in my clients application:</p>

<pre class="highlight plaintext"><code>$ cd Sites/example.com/
$ git submodule add git://github.com/philsturgeon/codeigniter-oauth2.git application/third_party/oauth2
</code></pre>

<p>So we’ve put this into our application/third_party folder, but this could just as easily have been in application/packages if you prefer the name. Whatever - the autoload.php config file can be changed to have whatever directory you want:</p>

<pre class="highlight plaintext"><code>$autoload['packages'] = array(APPPATH.'third_party');
</code></pre>

<p>Now we need to commit this so other developers have access to the code:</p>

<pre class="highlight plaintext"><code>$ git status


# On branch oauth2
# Changes to be committed:
#
#    new file:   .gitmodules
#    new file:   application/third_party/oauth2
</code></pre>

<p>The .gitmodules file has been added and keeps a reference of all submodules in your application.</p>

<h3 id="my-designer-just-pulled-and-its-broked">“My designer just pulled and it’s broked!”</h3>

<p>Me too! So submodules can be a little funny when people pull for the first time. The .gitmodule file will know there is a new submodule but Git won’t actually bother to do anything about it. This may seem odd but is easy to get around:</p>

<pre class="highlight plaintext"><code>$ git submodule init
$ git submodule update
</code></pre>

<p>The first command will initialize any submodules listed in the .gitmodule file that is not already set up, and update will grab the latest commit for it.</p>

<h3 id="committing-fixes-in-your-submodules">Committing fixes in your submodules</h3>

<p>While developing an application with a submodule you are no doubt adding new stuff as you go. Whether this is fixing bugs or adding new features you’re application is the best place to add these new features to your package because you can see when things are working.</p>

<p>If you have made some changes in your submodule you will notice that git status shows you this:</p>

<pre class="highlight plaintext"><code>$ git status


# On branch master
# Changes not staged for commit:
#
#    modified:   application/third_party/oauth2 (modified content)
</code></pre>

<p>We changed stuff! So let’s go and commit it to our submodule.</p>

<pre class="highlight plaintext"><code>$ cd application/third_party/oauth2
$ git status


# Not currently on any branch.
# Changes not staged for commit:
#
#    modified:   libraries/OAuth2.php
</code></pre>

<p>Woah there, not currently on any branch? What the dickens?</p>

<p>Each submodule has a specific commit used to reference which is the “current” commit that other applications should be on when they run git submodule update. Think of this much like a tag, but not actually a “tag”. We want to move out of this “no branch” and use master (or develop if you wan’t to get all crazy with Git-Flow).</p>

<pre class="highlight plaintext"><code>$ git checkout master
</code></pre>

<p>Awesome, now commit as usual and push back to the repo. If you cloned using a read-only remote (suggested if you want to deploy to PHPFog, etc) then you will need to do something like:</p>

<pre class="highlight plaintext"><code>$ git remote add upstream git@github.com:philsturgeon/codeigniter-oauth2.git
</code></pre>

<p>This will add the read/write remote to your system, but mean that deployment systems can still read the public remote when they look at origin. After that you push with:</p>

<pre class="highlight plaintext"><code>$ git push upstream master
</code></pre>

<p>Finally, if we hop back up to the root level of our application we’ll see:</p>

<pre class="highlight plaintext"><code>$ git status


# On branch master
# Changes not staged for commit:
#
#    modified:   application/third_party/oauth2
</code></pre>

<p>Commit that and you’re done. Yay!</p>

<h3 id="summary">Summary</h3>

<p>As with everything in Git it is initially confusing and potentially a little scary to try and work out, but once you get past the “WTFPALMFACE” section of learning you’ll love this feature and find yourself using it all over the place.</p>

        </section>
        <footer class="post-footer">
            <section class="share">
                  <a class="icon-twitter" href="https://twitter.com/share?text=Managing CodeIgniter Packages with Git Submodules&amp;url=https://philsturgeon.uk/codeigniter/2011/09/25/managing-codeigniter-packages-with-git-submodules/"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
                  <i class="fa fa-twitter"></i><span class="hidden">twitter</span>
                  </a>
                  <a class="icon-facebook" href="https://www.facebook.com/sharer.php?t=Managing CodeIgniter Packages with Git Submodules&amp;u=https://philsturgeon.uk/codeigniter/2011/09/25/managing-codeigniter-packages-with-git-submodules/"
                    onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
                  <i class="fa fa-facebook"></i><span class="hidden">facebook</span>
                  </a>
            </section>
            <section class="post-next-previous">
                <p>
                    Previous:
                    <a class="button" href="/fuelphp/2011/09/17/ninjauth-social-integration-php/">NinjAuth: The Social Integration Package PHP has been dying for</a>
                </p>
                <p style="float:right">
                    Next: 
                    <a class="button" href="/codeigniter/2011/10/06/new-codeigniter-documentation/">New CodeIgniter Documentation = Unicorn Party</a>
                </p>
            </section>
        </footer>
        <div class="bottom-teaser cf">
          <div class="more isLeft">
            <h5 class="index-headline featured"><span>Written by</span></h5>
            <section class="author">
              <div class="author-image" style="background-image: url(/images/author.jpg)">Blog Logo</div>
              <h4>Phil Sturgeon</h4>
              <p class="bio">I spend a lot of time urging people to learn more languages, and if that is a bit much learn another framework. Rails and Laravel are the same, and Go is a barrel of laughs.</p>
              <p>Get out of your rut.</p>
            </section>
          </div>
          <div class="more isRight">
            <h5 class="index-headline featured"><span>More Writing</span></h5>
            <section class="author">
              <a href="http://apisyouwonthate.com/">
                <div class="book-image build-apis">Book Cover</div>
                <h4>Build APIs You Won't Hate</h4>
              </a>
              <p class="bio">Everyone and their dog wants an API, so you should probably learn how to build them.</p>
              <p><a href="http://apisyouwonthate.com/">Buy it from LeanPub or Amazon</a>.</p>
            </section>
          </div>
        </div>
      </article>

      <div id="disqus_thread"></div>
      <script type="text/javascript">
          /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'philsturgeon';

          var disqus_identifier = 'managing-codeigniter-packages-with-git-submodules';

          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </main>
    <div class="bottom-closer">
      <div class="background-closer-image" style="background-image: url(/images/ciderphpants.jpg)">
        Image
      </div>
      <div class="inner">
        <h1 class="blog-title">Phil Sturgeon</h1>
        <h2 class="blog-description">I used to contribute to the PHP-FIG, The League of Extraordinary Packages, PHP The Right Way, CodeIgniter, FuelPHP, PyroCMS and a bunch of other stuff, but I gave it all up to join the circus</h2>
        <a href="/" class="btn">Back to Overview</a>
      </div>
    </div>

    <!-- content end -->

    <footer class='footer' role='contentinfo'>
  <div class='footer-links'>
    <ul class='context'>
      <li>
        <h3>Content</h3>
      </li>
      <li>
        <a href='/about'>About</a>
      </li>
      <li>
        <a href='/books'>Books</a>
      </li>
    </ul>
    <ul class='follow'>
      <li>
        <h3>Follow Me</h3>
      </li>
      <li>
        <a href='https://twitter.com/philsturgeon'>Twitter</a>
      </li>
      <li>
        <a href='https://github.com/'>GitHub</a>
      </li>
      <li>
        <a href='http://phptownhall.com/'>PHP Town Hall</a>
      </li>
    </ul>
    <ul class='recent_posts'>
      <li>
        <h3>Recent Posts</h3>
        <ul>
          <li><a href="/api/2015/10/08/http-documentation-with-api-blueprint/">HTTP Documentation with API Blueprint</a></li>
          <li><a href="/2015/10/02/everyones-favourite-twitter-character/">Everyones Favourite Twitter Characters</a></li>
          <li><a href="/http/2015/09/23/http-status-codes-are-not-enough/">HTTP Status Codes Are Not Enough</a></li>
        </ul>
      </li>
    </ul>
  </div>
</footer>

    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="/javascripts/jquery.fitvids.js"></script>
<script src="/javascripts/index.js"></script>
<script src="/javascripts/readingTime.min.js"></script>
<script>
(function ($) {
  "use strict";
  $(document).ready(function(){

    var $window = $(window),
    $image = $('.post-image-image, .teaserimage-image');
    $window.on('scroll', function() {
      var top = $window.scrollTop();

      if (top < 0 || top > 1500) { return; }
      $image
        .css('transform', 'translate3d(0px, '+top/3+'px, 0px)')
        .css('opacity', 1-Math.max(top/700, 0));
    });
    $window.trigger('scroll');

    var height = $('.article-image').height();
    $('.post-content').css('padding-top', height + 'px');

    $('a[href*=#]:not([href=#])').click(function() {
      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'')
       && location.hostname == this.hostname) {
        var target = $(this.hash);
        target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
        if (target.length) {
          $('html,body').animate({ scrollTop: target.offset().top }, 500);
          return false;
        }
      }
    });
  });
}(jQuery));
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8523256-1', 'auto');
  ga('send', 'pageview');

</script>


  </body>

</html>
