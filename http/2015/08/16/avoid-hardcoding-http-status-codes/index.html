<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Avoid Hardcoding HTTP Status Codes | Phil Sturgeon</title>
  <meta name="description" content="I used to contribute to the PHP-FIG, The League of Extraordinary Packages, PHP The Right Way, CodeIgniter, FuelPHP, PyroCMS and a bunch of other stuff, but I gave it all up to join the circus" />

  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <link rel="stylesheet" href="//brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  <link href="/stylesheets/main.css" rel="stylesheet" media="screen" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href="/images/favicon.png" rel="icon" type="image/png" />

  <meta property="og:title" content="Avoid Hardcoding HTTP Status Codes" />
  <meta property="og:type" content="article" />
  <meta property="article:author" content="Phil Sturgeon" />
  <meta property="og:description" content="A lot of things in programming are argued to death, but one subject where people almost unanimously agree is that magic numbers can be a pain in the ass, and they should be avoided whenever possible. Sadly when it comes to HTTP status codes, people keep on hardcoding them, and it leads to all sorts of confusion." />
  <meta property="og:site_name" content="Phil Sturgeon" />
  <meta property="og:image" content="https://philsturgeon.uk/images/author.jpg" />
  <meta property="og:url" content="https://philsturgeon.uk/http/2015/08/16/avoid-hardcoding-http-status-codes/" />
  <meta property="og:locale" content="en_GB" />
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@philsturgeon">
  <meta name="twitter:title" content="Avoid Hardcoding HTTP Status Codes | Phil Sturgeon">
  <meta name="twitter:image:src" content="https://philsturgeon.uk/images/author.jpg">
  <meta name="twitter:url" content="https://philsturgeon.uk/http/2015/08/16/avoid-hardcoding-http-status-codes/">
  <meta name="twitter:description" content="A lot of things in programming are argued to death, but one subject where people almost unanimously agree is that magic numbers can be a pain in the ass, and they should be avoided whenever possible. Sadly when it comes to HTTP status codes, people keep on hardcoding them, and it leads to all sorts of confusion.">
  <meta name="twitter:creator" content="@philsturgeon">
  
  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
</head>


  <body>

    <a class='fa fa-home logo-readium' href='/'></a>


    <!-- content start -->

    <main class="content" role="main">
      <article class="post">
        <div class="noarticleimage">
          <div class="post-meta">
            <h1 class="post-title">Avoid Hardcoding HTTP Status Codes</h1>
            <div class="cf post-meta-text">
              <div class="author-image" style="background-image: url(/images/author.jpg)">Blog Logo</div>
              <h4 class="author-name" itemprop="author" itemscope itemtype="http://schema.org/Person">Phil Sturgeon</h4>
              on
              <time datetime="2015-08-16 21:00:00 UTC">
                Aug 16 2015
              </time>
              <a href="/tags/http/">#http</a>
              <a href="/tags/api/">#api</a>
            </div>
          </div>
        </div>
        <br>
        <br>
        <br>
        <section class="post-content">
          <div class="post-reading">
            <span class="post-reading-time"></span> read
          </div>
          <a name="topofpage"></a>
          <p>A lot of things in programming are argued to death, but one subject where people almost unanimously agree is that magic numbers can be a pain in the ass, and they should be avoided whenever possible. Sadly when it comes to HTTP status codes, people keep on hardcoding them, and it leads to all sorts of confusion.</p>

<ol>
  <li>Remembering which code is which is incredibly difficult, even when you have spent 5 years of your life building APIs</li>
  <li>There are an awful lot of codes</li>
  <li>Even if you remember them, you are inviting trouble when new programmers are let loose on the codebase</li>
</ol>

<p>What is 409?</p>

<p>If you answer without looking it up on <a href="https://kapeli.com/dash">Dash</a> or <a href="http://httpstatusdogs.com">HTTP Status Dogs</a> then you are a machine.</p>

<p>Go has these built right into their main <code>net/http</code> library:</p>

<pre class="highlight go"><code><span class="n">http</span><span class="o">.</span><span class="n">StatusBadRequest</span><span class="x">
</span><span class="n">http</span><span class="o">.</span><span class="n">StatusOK</span><span class="x">
</span></code></pre>

<p>Ruby on Rails utilizes Rack to help solve this problem. The <a href="http://guides.rubyonrails.org/layouts_and_rendering.html#the-status-option">render option of Rails</a> offers a <code>:status</code> attribute, which defaults to <code>:ok</code> and can be set to any of the following options:</p>

<table>
  <thead>
    <tr>
      <th>Status</th>
      <th>Symbol</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>300</td>
      <td>:multiple_choices</td>
    </tr>
    <tr>
      <td>301</td>
      <td>:moved_permanently</td>
    </tr>
    <tr>
      <td>302</td>
      <td>:found</td>
    </tr>
    <tr>
      <td>303</td>
      <td>:see_other</td>
    </tr>
    <tr>
      <td>304</td>
      <td>:not_modified</td>
    </tr>
    <tr>
      <td>305</td>
      <td>:use_proxy</td>
    </tr>
    <tr>
      <td>306</td>
      <td>:reserved</td>
    </tr>
    <tr>
      <td>307</td>
      <td>:temporary_redirect</td>
    </tr>
    <tr>
      <td>308</td>
      <td>:permanent_redirect</td>
    </tr>
  </tbody>
</table>

<p>The list goes on, and is built on <a href="https://github.com/rack/rack/blob/master/lib/rack/utils.rb#L470">a big old array in Rack</a>.</p>

<p>Rack (and Rails) are not the only frameworks in the world to provide these options, <a href="https://github.com/symfony/HttpFoundation/blob/master/Response.php">Symfony has a go too</a> in <code>HttpFoundation</code>:</p>

<pre class="highlight php"><code>public function someAction(Request $request)
{
  return new Response('', Response::HTTP_NO_CONTENT);
}
</code></pre>

<p>I’d say that seeing <code>HTTP_NO_CONTENT</code> is quite a lot more useful than seeing <code>204</code> right? And any half decent IDE will let you know that <code>HTTP_NO_CONTENT</code> has the value of <code>204</code> anyway.</p>

<p>Sadly, the PHP tools outside of Symfony have been a bit lacking.</p>

<p>Laravel has a bunch of hardcoded status codes in <a href="http://laravel.com/docs/5.1/errors#http-exceptions">Custom HTTP Error Documention</a>, even though their responses are built on top of HttpFoundation.</p>

<p>Guzzle, and all PSR-7 stuff, provides the status code and the reason phrase (which can theoretically change if your API developer is a smart-ass), so again you’re working with magic numbers.</p>

<pre class="highlight php"><code>$response = $client-&gt;get('http://www.amazon.com')-&gt;send();

echo $response-&gt;getStatusCode();      // &gt;&gt;&gt; 200
echo $response-&gt;getReasonPhrase();    // &gt;&gt;&gt; OK
</code></pre>

<p>Most folks who become fed up with hardcoding status codes end up implementing their own solution, but this is just more code that needs to be tested and I’ve seen a few people actually get some of the codes wrong…</p>

<p>The solution here is to provide a reusable package, which contains the constants without needing all of Symfony HttpFoundation available to work.</p>

<p>Recently one turned up on <a href="https://groups.google.com/forum/#!topic/thephpleague/iBfghcg3TJc">The League mailing list</a> which ended up being built as <a href="https://github.com/lukasoppermann/http-status">lukasoppermann/http-status</a>. Since then I noticed another one, called <a href="https://github.com/shrikeh/teapot">Teapot</a>.</p>

<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">use</span> <span class="nx">\Teapot\StatusCode</span><span class="p">;</span>
<span class="nv">$code</span> <span class="o">=</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getStatusCode</span><span class="p">();</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertNotEquals</span><span class="p">(</span><span class="nx">StatusCode</span><span class="o">::</span><span class="na">NOT_FOUND</span><span class="p">,</span> <span class="nv">$code</span><span class="p">);</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertNotEquals</span><span class="p">(</span><span class="nx">StatusCode</span><span class="o">::</span><span class="na">FORBIDDEN</span><span class="p">,</span> <span class="nv">$code</span><span class="p">);</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertNotEquals</span><span class="p">(</span><span class="nx">StatusCode</span><span class="o">::</span><span class="na">MOVED_PERMANENTLY</span><span class="p">,</span> <span class="nv">$code</span><span class="p">);</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span><span class="nx">StatusCode</span><span class="o">::</span><span class="na">CREATED</span><span class="p">,</span> <span class="nv">$code</span><span class="p">);</span>
</code></pre>

<p>Nice and simple.</p>

<p>There is some room for the PHP-FIG to improve this situation I think, as the PHP community does not have a single Rack-like system where all this stuff is done already.</p>

<p>I don’t mind how you go about avoiding hardcoded HTTP status codes in your projects, but please avoid doing it somehow.</p>

<p>If you want more advice on HTTP/API stuff, grab a copy of my book <a href="http://apisyouwonthate.com/">Build APIs You Won’t Hate</a>. You can get that eBook for free if you donate $10 to my next <a href="http://fundraising.housingworks.org/index.cfm?fuseaction=donordrive.participant&amp;participantID=2035">charity bike ride</a>.</p>

        </section>
        <footer class="post-footer">
            <section class="share">
                  <a class="icon-twitter" href="https://twitter.com/share?text=Avoid Hardcoding HTTP Status Codes&amp;url=https://philsturgeon.uk/http/2015/08/16/avoid-hardcoding-http-status-codes/"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
                  <i class="fa fa-twitter"></i><span class="hidden">twitter</span>
                  </a>
                  <a class="icon-facebook" href="https://www.facebook.com/sharer.php?t=Avoid Hardcoding HTTP Status Codes&amp;u=https://philsturgeon.uk/http/2015/08/16/avoid-hardcoding-http-status-codes/"
                    onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
                  <i class="fa fa-facebook"></i><span class="hidden">facebook</span>
                  </a>
            </section>
            <section class="post-next-previous">
                <p>
                    Previous:
                    <a class="button" href="/charity/2015/08/11/geeks-giving-for-aids-again/">Geeks Giving for Aids: 2015</a>
                </p>
                <p style="float:right">
                    Next: 
                    <a class="button" href="/feminism/2015/08/17/women-speaker-ratio-conversation-loop/">The Ratio of Women Speakers in Tech</a>
                </p>
            </section>
        </footer>
        <div class="bottom-teaser cf">
          <div class="isLeft">
            <h5 class="index-headline featured"><span>Written by</span></h5>
            <section class="author">
              <div class="author-image" style="background-image: url(/images/author.jpg)">Blog Logo</div>
              <h4>Phil Sturgeon</h4>
              <p class="bio">Phil has contributed to CodeIgniter, FuelPHP, Laravel and handfuls of other projects, to try and make the PHP community a better place.</p>
              <hr>
              <p class="published">Published <time datetime="2015-08-16 21:00:00 UTC">Aug 16 2015</time></p>
            </section>
          </div>
          <div class="isRight">
            <h5 class="index-headline featured"><span>More Writing</span></h5>
            <footer class="site-footer">
              <h4>Build APIs You Won't Hate</h4>
              <p>Everyone and their dog wants an API, so you should probably learn how to build them.</p>
              <p><a href="http://apisyouwonthate.com/">Buy it from LeanPub or Amazon</a></p>
              <hr>
              <p class="published">Published Feb 1 2014</p>
            </footer>
          </div>
        </div>
      </article>

      <div id="disqus_thread"></div>
      <script type="text/javascript">
          /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'philsturgeon';


          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </main>
    <div class="bottom-closer">
      <div class="background-closer-image" style="background-image: url(/images/ciderphpants.jpg)">
        Image
      </div>
      <div class="inner">
        <h1 class="blog-title">Phil Sturgeon</h1>
        <h2 class="blog-description">I used to contribute to the PHP-FIG, The League of Extraordinary Packages, PHP The Right Way, CodeIgniter, FuelPHP, PyroCMS and a bunch of other stuff, but I gave it all up to join the circus</h2>
        <a href="/" class="btn">Back to Overview</a>
      </div>
    </div>

    <!-- content end -->

    <footer class='footer' role='contentinfo'>
  <div class='footer-links'>
    <ul class='context'>
      <li>
        <h3>Content</h3>
      </li>
      <li>
        <a href='/about'>About</a>
      </li>
      <li>
        <a href='/books'>Books</a>
      </li>
    </ul>
    <ul class='follow'>
      <li>
        <h3>Follow Me</h3>
      </li>
      <li>
        <a href='https://twitter.com/philsturgeon'>Twitter</a>
      </li>
      <li>
        <a href='https://github.com/'>GitHub</a>
      </li>
      <li>
        <a href='http://phptownhall.com/'>PHP Town Hall</a>
      </li>
    </ul>
    <ul class='recent_posts'>
      <li>
        <h3>Recent Posts</h3>
        <ul>
          <li><a href="/http/2015/09/03/auto-incrementing-to-destruction/">Auto-Incrementing IDs: Giving your Data Away</a></li>
          <li><a href="/charity/2015/08/22/no-booze/">No Booze for a Month</a></li>
          <li><a href="/feminism/2015/08/17/women-speaker-ratio-conversation-loop/">The Ratio of Women Speakers in Tech</a></li>
        </ul>
      </li>
    </ul>
  </div>
</footer>

    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="/javascripts/jquery.fitvids.js"></script>
<script src="/javascripts/index.js"></script>
<script src="/javascripts/readingTime.min.js"></script>
<script>
(function ($) {
  "use strict";
  $(document).ready(function(){

    var $window = $(window),
    $image = $('.post-image-image, .teaserimage-image');
    $window.on('scroll', function() {
      var top = $window.scrollTop();

      if (top < 0 || top > 1500) { return; }
      $image
        .css('transform', 'translate3d(0px, '+top/3+'px, 0px)')
        .css('opacity', 1-Math.max(top/700, 0));
    });
    $window.trigger('scroll');

    var height = $('.article-image').height();
    $('.post-content').css('padding-top', height + 'px');

    $('a[href*=#]:not([href=#])').click(function() {
      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'')
       && location.hostname == this.hostname) {
        var target = $(this.hash);
        target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
        if (target.length) {
          $('html,body').animate({ scrollTop: target.offset().top }, 500);
          return false;
        }
      }
    });
  });
}(jQuery));
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8523256-1', 'auto');
  ga('send', 'pageview');

</script>


  </body>

</html>
