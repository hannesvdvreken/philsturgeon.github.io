<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Why do some PHP Developers &lt;3 Static APIs? | Phil Sturgeon</title>
  <meta name="description" content="I used to contribute to the PHP-FIG, The League of Extraordinary Packages, PHP The Right Way, CodeIgniter, FuelPHP, PyroCMS and a bunch of other stuff, but I gave it all up to join the circus" />

  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <link rel="stylesheet" href="//brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  <link href="/stylesheets/main.css" rel="stylesheet" media="screen" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href="/images/favicon.png" rel="icon" type="image/png" />

  <meta property="og:title" content="Why do some PHP Developers &lt;3 Static APIs?" />
  <meta property="og:type" content="article" />
  <meta property="article:author" content="Phil Sturgeon" />
  <meta property="og:description" content="There are two kinds of PHP developers. Those who absolutely love static methods because they are easy to work with and those who think they are spawned by satan to test our devotion to proper programming practises." />
  <meta property="og:site_name" content="Phil Sturgeon" />
  <meta property="og:image" content="https://philsturgeon.uk/images/author.jpg" />
  <meta property="og:url" content="https://philsturgeon.uk/php/2012/12/31/why-do-some-php-devs-love-static/" />
  <meta property="og:locale" content="en_GB" />
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@philsturgeon">
  <meta name="twitter:title" content="Why do some PHP Developers &amp;lt;3 Static APIs? | Phil Sturgeon">
  <meta name="twitter:image:src" content="https://philsturgeon.uk/images/author.jpg">
  <meta name="twitter:url" content="https://philsturgeon.uk/php/2012/12/31/why-do-some-php-devs-love-static/">
  <meta name="twitter:description" content="There are two kinds of PHP developers. Those who absolutely love static methods because they are easy to work with and those who think they are spawned by satan to test our devotion to proper programming practises.">
  <meta name="twitter:creator" content="@philsturgeon">
  
  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
</head>


  <body>

    <a class='fa fa-home logo-readium' href='/'></a>


    <!-- content start -->

    <main class="content" role="main">
      <article class="post">
        <div class="noarticleimage">
          <div class="post-meta">
            <h1 class="post-title">Why do some PHP Developers &amp;lt;3 Static APIs?</h1>
            <div class="cf post-meta-text">
              <div class="author-image" style="background-image: url(/images/author.jpg)">Blog Logo</div>
              <h4 class="author-name" itemprop="author" itemscope itemtype="http://schema.org/Person">Phil Sturgeon</h4>
              on
              <time datetime="2012-12-31 16:25:00 UTC">
                Dec 31 2012
              </time>
            </div>
          </div>
        </div>
        <br>
        <br>
        <br>
        <section class="post-content">
          <div class="post-reading">
            <span class="post-reading-time"></span> read
          </div>
          <a name="topofpage"></a>
          <p>There are two kinds of PHP developers. Those who absolutely love static methods because they are easy to work with and those who think they are spawned by satan to test our devotion to proper programming practises.</p>

<p>This article is not intended to explain why statics are ok, I instead hope to use my experience with a few PHP frameworks - and the power of hindsight - to explain why some developers ignore best practises and use a whole bunch of statics.</p>

<h2 id="who-loves-statics">Who loves statics?</h2>

<p>Most people who have ever used <a href="http://codeigniter.com">CodeIgniter</a>.</p>

<p>That means most Kohana developers, a bunch of you Laravel types and people who have moved away from using CodeIgniter to write their own stuff.</p>

<p>Why you might ask?</p>

<p>CodeIgniter’s PHP 4 design obviously came before static methods were added into PHP 5.0. CodeIgniter uses a “super-global” instance which allows equal access to all loaded classes, which are all basically assigned to the controller, so they can be used throughout the system.</p>

<p>This means they can be accessed from any model method using a __get() which will look for that requested property using <code>get_instance()-&gt;{$var}</code>. Before that (obviously __get() wasn’t around in PHP 4) they used to foreach through CI_Controller properties, then assign them to $this in the model.</p>

<p>In a library you have to call get_instance yourself (because libraries do not force you to inherit any class, so there is no way to hack in a __get().</p>

<h2 id="gross">Gross…</h2>

<p>Yeah, this is some fairly crazy hackery to give you access to your code. Using statics can achieve the exact same functionality without the hackery.</p>

<p>Even the reasoning for the hackery didn’t make much sense. “Oh good, I can access my session data in my model”. AHHH! Why are you accessing your session data in your model? I will beat you with the bad-practise stick until you move it back out.</p>

<h2 id="the-solution">The “Solution”</h2>

<p>The Kohana developers were the first to get serious hard-ons for statics, and thought they had fixed this by making changes like the following:</p>

<pre class="highlight plaintext"><code>$this-&gt;input-&gt;get('foo');
// becomes
Input::get('foo');
</code></pre>

<p>This was like candy for many CI developers, who outright shunned CodeIgniter for it’s PHP 4 global code and moved to Kohana to use its PHP 5 style global code. That’s not much of an improvement overall, but at least it did not require multiple secret background hacks to make the logic work. Besides, less characters is always better, “right”?</p>

<h2 id="why-is-this-bad">Why is this bad?</h2>

<p>Many PHP developers (especially those well versed in Symfony and Zend) will say “Dependency Injection, obviously!” but not many developers in the CodeIgniter community have any real experience with DI is as the framework makes it pretty difficult - so that’s not an argument I can use to explain things to those guys.</p>

<p>Instead another argument, one which was very valid for FuelPHP - which while mostly using statics as an interface for instance logic still had issues with statics, especially when HMVC was involved.</p>

<p><em>This is all pseudo-code as I haven’t used FuelPHP since about 1.1 and things have probably changed, but I know these general issues still exist.</em></p>

<pre class="highlight plaintext"><code>class ControllerA extends Controller
{	
	public function action_foo()
	{
		echo Input::get('param');
	}
}
</code></pre>

<p>Fairly standard stuff. This method will output the value of <code>?bar=</code> in the method.</p>

<p>What happens when we make a HMVC request to this method?</p>

<pre class="highlight plaintext"><code>class ControllerB extends Controller
{	
	public function action_baz()
	{
		echo Input::get('param');
		echo " &amp; ";
		echo Request::forge('controllera/foo?param=val1')-&gt;execute();
	}
}
</code></pre>

<p>If you call <code>controllerb/baz</code> in your browser then you’ll see “val1” output, but if you call <code>controllerb/baz?param=override</code> then you’re going to get both calls to the get method return the same value.</p>

<h2 id="relevance">Relevance</h2>

<p>Global code gives you no relevance, or scope might be a better word. In this example we would actually want to reference:</p>

<pre class="highlight plaintext"><code>$this-&gt;request-&gt;input-&gt;get('param');
</code></pre>

<p>The Request object would contain a brand-new instance for each request, then input would again be another object instantiated for each request that contained only input data for that specific request. This is exactly how <a href="http://fuelphp.com/blogs/2012/03/why-the-20-changes">FuelPHP 2.0 plans to work</a>, and solves the DI problem as well as the issues for HMVC.</p>

<h2 id="but-that-syntax-is-gross">But that syntax is gross!</h2>

<p>You’ll never hear that from a Symfony or Zend developer, but anyone using CodeIgniter will flip their shit at the thought of “going back to PHP 4”.</p>

<p>Referencing code from $this to many seems like a PHP 4 approach, while static is PHP 5 and this is frustrating to try to get past.</p>

<p>$this should refer to the “current” object. Always.</p>

<p>Using $this to access all global code ever is terrible. Fact.</p>

<p>So, while $this-&gt;request-&gt;input-&gt;get() might look like it’s even longer-form CodeIgniter syntax, really we’re just sat in a controller. When the controller is instantiated an instance of new Request is assigned to it, and the constructor of Request gets an instance on Input too.</p>

<p>If you’re sat in a model or other class, then accessing $this-&gt;request-&gt;input-&gt;foo() is not going to work, because $this is not a controller. Instead you would need to pass the request object into the method as an argument instead.</p>

<h2 id="so-no-static-ever">So… no static ever?</h2>

<p>At this point there are just so many people tied to static love that it’s hard to break them away. FuelPHP 2.0 and Laravel 4.0 are trying to cater for this by implementing a “Facade” layer of some description. See this writeup of <a href="http://www.thenerdary.net/post/30859565484/laravel-4">how the Facade will work in Laravel 4</a>.</p>

<p>That means, while you CAN access Input::get(‘foo’) it’s actually acting as a facade for instantiated logic in the background. That said, it still has all of the issues of global code, so if folks want to be lazy they can do it that way - then once they get bitten in the ass a few times trying to test their applications they can start to make the switch, without needing to totally use a new framework.</p>

<p>A great video by Taylor Otwell (creator or Laravel 4) outlines why and how you can replace static code with unit-testable instances via his DiC container.</p>

<iframe src="http://player.vimeo.com/video/53029232" width="500" height="279" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe>
<p><a href="http://vimeo.com/53029232">Laravel 4 - IoC Controller Injection &amp; Unit Testing</a> from <a href="http://vimeo.com/userscape">UserScape</a> on <a href="http://vimeo.com">Vimeo</a>.</p>

<p>This hopefully shows off that static usage in Laravel is extremely optional, and while some modern-day frameworks certainly look like Kohana on the first glance they absolutely are not still doing things the same-old way.</p>

<h2 id="sidesad-note">Side/Sad Note</h2>

<p>Right now I am converting <a href="https://www.pyrocms.com/">PyroCMS</a> from CodeIgniter to Laravel, and trying to take it straight from PHP 4 global code to perfect dependency injected code is absolute murder. So, an in-between step is being made to switch from using the CI loader to at least using PHP 5, PSR-2 autoloaded code, with a bunch of statics while we’re still in CodeIgniter.</p>

<p>Then, switching from those statics to DiC code as highlight in the video will be made easy when we finally make the switch to Laravel.</p>

<p>Going from tightly-coupled CodeIgniter code to testable PSR-2 is an absolute mission, but the Pyro team are on it - and it’s going to be epic.</p>

        </section>
        <footer class="post-footer">
            <section class="share">
                  <a class="icon-twitter" href="https://twitter.com/share?text=Why do some PHP Developers &amp;lt;3 Static APIs?&amp;url=https://philsturgeon.uk/php/2012/12/31/why-do-some-php-devs-love-static/"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
                  <i class="fa fa-twitter"></i><span class="hidden">twitter</span>
                  </a>
                  <a class="icon-facebook" href="https://www.facebook.com/sharer.php?t=Why do some PHP Developers &amp;lt;3 Static APIs?&amp;u=https://philsturgeon.uk/php/2012/12/31/why-do-some-php-devs-love-static/"
                    onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
                  <i class="fa fa-facebook"></i><span class="hidden">facebook</span>
                  </a>
            </section>
            <section class="post-next-previous">
                <p>
                    Previous:
                    <a class="button" href="/codeigniter/2012/12/27/arguing-on-the-internet/">Arguing on the Internet</a>
                </p>
                <p style="float:right">
                    Next: 
                    <a class="button" href="/ruby/2013/01/17/building-an-itunes-feed-with-octopress/">Building an iTunes feed with Octopress</a>
                </p>
            </section>
        </footer>
        <div class="bottom-teaser cf">
          <div class="isLeft">
            <h5 class="index-headline featured"><span>Written by</span></h5>
            <section class="author">
              <div class="author-image" style="background-image: url(/images/author.jpg)">Blog Logo</div>
              <h4>Phil Sturgeon</h4>
              <p class="bio">Phil has contributed to CodeIgniter, FuelPHP, Laravel and handfuls of other projects, to try and make the PHP community a better place.</p>
              <hr>
              <p class="published">Published <time datetime="2012-12-31 16:25:00 UTC">Dec 31 2012</time></p>
            </section>
          </div>
          <div class="isRight">
            <h5 class="index-headline featured"><span>More Writing</span></h5>
            <footer class="site-footer">
              <h4>Build APIs You Won't Hate</h4>
              <p>Everyone and their dog wants an API, so you should probably learn how to build them.</p>
              <p><a href="http://apisyouwonthate.com/">Buy it from LeanPub or Amazon</a></p>
              <hr>
              <p class="published">Published Feb 1 2014</p>
            </footer>
          </div>
        </div>
      </article>

      <div id="disqus_thread"></div>
      <script type="text/javascript">
          /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'philsturgeon';

          var disqus_identifier = 'why-do-some-php-devs-love-static';

          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </main>
    <div class="bottom-closer">
      <div class="background-closer-image" style="background-image: url(/images/ciderphpants.jpg)">
        Image
      </div>
      <div class="inner">
        <h1 class="blog-title">Phil Sturgeon</h1>
        <h2 class="blog-description">I used to contribute to the PHP-FIG, The League of Extraordinary Packages, PHP The Right Way, CodeIgniter, FuelPHP, PyroCMS and a bunch of other stuff, but I gave it all up to join the circus</h2>
        <a href="/" class="btn">Back to Overview</a>
      </div>
    </div>

    <!-- content end -->

    <footer class='footer' role='contentinfo'>
  <div class='footer-links'>
    <ul class='context'>
      <li>
        <h3>Content</h3>
      </li>
      <li>
        <a href='/about'>About</a>
      </li>
      <li>
        <a href='/books'>Books</a>
      </li>
    </ul>
    <ul class='follow'>
      <li>
        <h3>Follow Me</h3>
      </li>
      <li>
        <a href='https://twitter.com/philsturgeon'>Twitter</a>
      </li>
      <li>
        <a href='https://github.com/'>GitHub</a>
      </li>
      <li>
        <a href='http://phptownhall.com/'>PHP Town Hall</a>
      </li>
    </ul>
    <ul class='recent_posts'>
      <li>
        <h3>Recent Posts</h3>
        <ul>
          <li><a href="/http/2015/09/03/auto-incrementing-to-destruction/">Auto-Incrementing IDs: Giving your Data Away</a></li>
          <li><a href="/charity/2015/08/22/no-booze/">No Booze for a Month</a></li>
          <li><a href="/feminism/2015/08/17/women-speaker-ratio-conversation-loop/">The Ratio of Women Speakers in Tech</a></li>
        </ul>
      </li>
    </ul>
  </div>
</footer>

    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="/javascripts/jquery.fitvids.js"></script>
<script src="/javascripts/index.js"></script>
<script src="/javascripts/readingTime.min.js"></script>
<script>
(function ($) {
  "use strict";
  $(document).ready(function(){

    var $window = $(window),
    $image = $('.post-image-image, .teaserimage-image');
    $window.on('scroll', function() {
      var top = $window.scrollTop();

      if (top < 0 || top > 1500) { return; }
      $image
        .css('transform', 'translate3d(0px, '+top/3+'px, 0px)')
        .css('opacity', 1-Math.max(top/700, 0));
    });
    $window.trigger('scroll');

    var height = $('.article-image').height();
    $('.post-content').css('padding-top', height + 'px');

    $('a[href*=#]:not([href=#])').click(function() {
      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'')
       && location.hostname == this.hostname) {
        var target = $(this.hash);
        target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
        if (target.length) {
          $('html,body').animate({ scrollTop: target.offset().top }, 500);
          return false;
        }
      }
    });
  });
}(jQuery));
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8523256-1', 'auto');
  ga('send', 'pageview');

</script>


  </body>

</html>
