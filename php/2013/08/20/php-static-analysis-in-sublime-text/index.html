<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>PHP Static Analysis in Sublime Text | Phil Sturgeon</title>
  <meta name="description" content="I used to contribute to the PHP-FIG, The League of Extraordinary Packages, PHP The Right Way, CodeIgniter, FuelPHP, PyroCMS and a bunch of other stuff, but I gave it all up to join the circus" />

  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <link rel="stylesheet" href="//brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  <link href="/stylesheets/main.css" rel="stylesheet" media="screen" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href="/images/favicon.png" rel="icon" type="image/png" />

  <meta property="og:name" content="Phil Sturgeon">
  <meta property="og:image" content="https://philsturgeon.uk/images/author.jpg">
  <meta property="og:description" content="Coding Standards have been around for the longest time and recently they’re starting to become more widespread in PHP. While learning Python I really enjoyed how Sublime Text 2 would shout at me for using too many empty lines, using tabs instead of spaces and even things like declaring unused local variables, importing modules that were never used, etc. This was pretty cool, and I was soon writing beautiful Python code without any concern over which way things should be done.">
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@philsturgeon">
  <meta name="twitter:title" content="PHP Static Analysis in Sublime Text | Phil Sturgeon">
  <meta name="twitter:creator" content="@philsturgeon">
  <meta name="twitter:image:src" content="https://philsturgeon.uk/images/author.jpg">
  <meta name="twitter:url" content="https://philsturgeon.uk/php/2013/08/20/php-static-analysis-in-sublime-text/">
  <meta name="twitter:description" content="Coding Standards have been around for the longest time and recently they’re starting to become more widespread in PHP. While learning Python I really enjoyed how Sublime Text 2 would shout at me for using too many empty lines, using tabs instead of spaces and even things like declaring unused local variables, importing modules that were never used, etc. This was pretty cool, and I was soon writing beautiful Python code without any concern over which way things should be done.">
  
  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
</head>


  <body>

    <a class='fa fa-home logo-readium' href='/'></a>


    <!-- content start -->

    <main class="content" role="main">
      <article class="post">
        <div class="noarticleimage">
          <div class="post-meta">
            <h1 class="post-title">PHP Static Analysis in Sublime Text</h1>
            <div class="cf post-meta-text">
              <div class="author-image" style="background-image: url(/images/author.jpg)">Blog Logo</div>
              <h4 class="author-name" itemprop="author" itemscope itemtype="http://schema.org/Person">Phil Sturgeon</h4>
              on
              <time datetime="2013-08-20 17:20:00 UTC">
                Aug 20 2013
              </time>
            </div>
          </div>
        </div>
        <br>
        <br>
        <br>
        <section class="post-content">
          <div class="post-reading">
            <span class="post-reading-time"></span> read
          </div>
          <a name="topofpage"></a>
          <p>Coding Standards have been around for the longest time and recently they’re starting to become more widespread in PHP. While learning Python I really enjoyed how Sublime Text 2 would shout at me for using too many empty lines, using tabs instead of spaces and even things like declaring unused local variables, importing modules that were never used, etc. This was pretty cool, and I was soon writing beautiful Python code without any concern over which way things should be done.</p>

<p>I’ve been doing this with PHP for the last year, but trying to get a new-hire going with this stuff was hard. We smashed through it taking notes so now I’ve written it up for you guys.</p>

<h2 id="step-1-match-php-versions-with-your-dev-environment">Step 1: Match PHP versions with your dev environment</h2>

<p>If you locally develop using <a href="http://www.vagrantup.com">Vagrant</a> or some other VM (and you really should be) you will most likely have a different local version of PHP to the one in the box.</p>

<p><em>For me, on OSX <code>php -v</code> displayed PHP 5.3.15 and vagrant is on 5.4.6. Using <a href="http://brew.sh/">homebrew</a> and the <a href="https://github.com/josegonzalez/homebrew-php">homebrew-php</a> repo this was relatively easy.</em></p>

<p>You don’t need to install all the extensions and everything to make it a fully operational environment, you just need to make sure that when <code>php -l</code> runs, Sublime Text 2 is using a version that understands the same syntax. For example, if you skip this step and your local version of php is 5.3, Sublime Text is going to shout errors at you every time you try to use a trait or short array syntax.</p>

<h2 id="step-2-moar-static-analysis-tools">Step 2: Moar Static Analysis Tools</h2>

<p>There are several tools we’ll be using: <a href="http://phpmd.org/">PHP Mess Detector</a>, <a href="https://github.com/squizlabs/PHP_CodeSniffer">PHP CodeSniffer</a> and <a href="https://github.com/fabpot/PHP-CS-Fixer">PHP Coding Standards Fixer</a>.</p>

<s>_Depending on how you have PEAR installed, you might need to prefix these commands with `sudo`._</s>

<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre>$ pear channel-discover pear.phpmd.org
$ pear channel-discover pear.pdepend.org
$ pear install --alldeps phpmd/PHP\_PMD
$ pear install PHP\_CodeSniffer
</pre></td></tr></tbody></table>
</div>

<p><strong>Update 13/12/2013:</strong> The reason I originally suggested PEAR was down to homebrew doing some fairly odd shit when I tried installing these packages. It was trying to install a .phar but PHP was not allowed to create a phar itself, so I had to switch phar.readonly to Off in php.ini. It might be worth doing that - just to avoid PEAR - so once you’ve made the change run this:</p>

<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre>$ brew tap josegonzalez/homebrew-php
$ brew install phpmd
$ brew install php-code-sniffer
$ brew install php-cs-fixer
</pre></td></tr></tbody></table>
</div>

<h2 id="step-3-install-the-sublime-php-cs-plugin">Step 3: Install the Sublime PHP CS plugin</h2>

<p>This is <a href="http://www.soulbroken.co.uk/code/sublimephpcs/">the plugin</a> that brings it all together.</p>

<p>You’ll need to go to “Preferences &gt; Package Settings &gt; PHP CodeSniffer &gt; Settings - Default”. Set these values:</p>

<div class="highlight javascript"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre><span class="c1">// Show the errors in the quick panel so you can then goto line</span>
<span class="s2">"phpcs\_show\_quick_panel"</span><span class="err">:</span> <span class="kc">false</span><span class="p">,</span>
</pre></td></tr></tbody></table>
</div>

<p>Switching that to false will avoid the obnoxious pop-up that lists all errors in your face. Sometimes you want to ignore a few errors, this won’t let you.</p>

<div class="highlight javascript"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre><span class="c1">// It seems python/sublime cannot always find the phpcs application</span>
<span class="c1">// If empty, then use PATH version of phpcs, else use the set value</span>
<span class="s2">"phpcs\_executable\_path"</span><span class="err">:</span> <span class="s2">"/usr/bin/phpcs"</span><span class="p">,</span>
</pre></td></tr></tbody></table>
</div>

<p>Set the full path to phpcs. You can use <code>which phpcs</code> for this.</p>

<div class="highlight javascript"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre><span class="s2">"phpcs\_additional\_args"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"--standard"</span><span class="err">:</span> <span class="s2">"psr2"</span><span class="p">,</span>
    <span class="s2">"-n"</span><span class="err">:</span> <span class="s2">""</span>
<span class="p">},</span>
</pre></td></tr></tbody></table>
</div>

<p>Because you know you love spaces over tabs.</p>

<div class="highlight javascript"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre><span class="c1">// Path to where you have the php-cs-fixer installed</span>
<span class="s2">"php\_cs\_fixer\_executable\_path"</span><span class="err">:</span> <span class="s2">"/usr/local/bin/php-cs-fixer"</span><span class="p">,</span>
</pre></td></tr></tbody></table>
</div>

<p>Find the fixer.</p>

<div class="highlight javascript"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre><span class="c1">// Are we going to run php -l over the file?</span>
<span class="s2">"phpcs\_linter\_run"</span><span class="err">:</span> <span class="kc">true</span><span class="p">,</span>
</pre></td></tr></tbody></table>
</div>

<p>Here is the linting we were taking about.</p>

<div class="highlight javascript"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre><span class="c1">// Execute phpmd</span>
<span class="s2">"phpmd\_run"</span><span class="err">:</span> <span class="kc">true</span><span class="p">,</span>
</pre></td></tr></tbody></table>
</div>

<p>Will shout at you for producing stupidly complex functions and methods. If it says a method is complicated, try splitting it in half.</p>

<div class="highlight javascript"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre><span class="c1">// It seems python/sublime cannot always find the phpmd application</span>
<span class="c1">// If empty, then use PATH version of phpmd, else use the set value</span>
<span class="s2">"phpmd\_executable\_path"</span><span class="err">:</span> <span class="s2">"/usr/bin/phpmd"</span><span class="p">,</span>
</pre></td></tr></tbody></table>
</div>

<p>Tell Sublime where phpmd is.</p>

<p>Play around with the other settings if you like, but do that in “Settings - User” so you still have this default to fall back on. This default is the least invasive and most useful setup I have so far, but can certainly be tweaked.</p>

<h2 id="other-ides">Other IDEs</h2>

<p>If you want to do this with something other than Sublime Text then there are plenty of other options.</p>

<p>Only one IDE I’ve spotted so far has CodeSniffer support out of the box:</p>

<ul>
  <li><a href="http://www.jetbrains.com/phpstorm/webhelp/code-sniffer.html">PHPStorm</a></li>
</ul>

<p>Some require extensions but have some simple tutorials:</p>

<ul>
  <li><a href="http://www.rdeeson.com/weblog/89/enforce-coding-standards-with-php_codesniffer-and-eclipse-ide-on-ubuntu-linux.html">Eclipse</a></li>
  <li><a href="http://www.amaxus.com/cms-blog/coding-standards-netbeans-php-codesniffer">NetBeans</a></li>
  <li><a href="http://joncairns.com/2012/03/vim-with-php-code-sniffer-mess-detector-and-code-coverage/">VIM</a></li>
</ul>

<p>Whether you think coding standards are important or not, at some point in your career you are almost certainly going to be forced to use one. Some Lead Developers like me will use CodeSniffer to detect invalid formatting on the Continuous Integration server (Jenkins, Travis-CI, Bamboo, etc). Depending on how the thresholds for checkstyle warnings are configured, a developer placing too many brackets and new lines in the wrong place could mark the build as unstable, or even fail it.</p>

<p>This might all sound petty, but some rules have extremely valid reasons. You put a new line at the end of the file? That could let whitespace sneak into the output, which will cause bugs in production. I figure it is better for your IDE/editor to shouts at you, rather than the whole dev team.</p>

        </section>
        <footer class="post-footer">
            <section class="share">
                  <a class="icon-twitter" href="https://twitter.com/share?text=PHP Static Analysis in Sublime Text&amp;url=https://philsturgeon.uk/php/2013/08/20/php-static-analysis-in-sublime-text/"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
                  <i class="fa fa-twitter"></i><span class="hidden">twitter</span>
                  </a>
                  <a class="icon-facebook" href="https://www.facebook.com/sharer.php?t=PHP Static Analysis in Sublime Text&amp;u=https://philsturgeon.uk/php/2013/08/20/php-static-analysis-in-sublime-text/"
                    onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
                  <i class="fa fa-facebook"></i><span class="hidden">facebook</span>
                  </a>
            </section>
            <section class="post-next-previous">
                <p>
                    Previous:
                    <a class="button" href="/php/2013/08/14/progress-in-the-phpfig/">Progress in the PHP-FIG</a>
                </p>
                <p style="float:right">
                    Next: 
                    <a class="button" href="/php/2013/08/21/fud-cracker-php-55-never-lost-json-support/">FUD Cracker: PHP 5.5 never lost JSON support</a>
                </p>
            </section>
        </footer>
        <div class="bottom-teaser cf">
          <div class="isLeft">
            <h5 class="index-headline featured"><span>Written by</span></h5>
            <section class="author">
              <div class="author-image" style="background-image: url(/images/author.jpg)">Blog Logo</div>
              <h4>Phil Sturgeon</h4>
              <p class="bio">Phil has contributed to CodeIgniter, FuelPHP, Laravel and handfuls of other projects, to try and make the PHP community a better place.</p>
              <hr>
              <p class="published">Published <time datetime="2013-08-20 17:20:00 UTC">Aug 20 2013</time></p>
            </section>
          </div>
          <div class="isRight">
            <h5 class="index-headline featured"><span>More Writing</span></h5>
            <footer class="site-footer">
              <h4>Build APIs You Won't Hate</h4>
              <p>Everyone and their dog wants an API, so you should probably learn how to build them.</p>
              <p><a href="http://apisyouwonthate.com/">Buy it from LeanPub or Amazon</a></p>
              <hr>
              <p class="published">Published 01 Feb 2014</p>
            </footer>
          </div>
        </div>
      </article>

      <div id="disqus_thread"></div>
      <script type="text/javascript">
          /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'philsturgeon';

          var disqus_identifier = 'php-static-analysis-in-sublime-text';

          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </main>
    <div class="bottom-closer">
      <div class="background-closer-image" style="background-image: url(/images/ciderphpants.jpg)">
        Image
      </div>
      <div class="inner">
        <h1 class="blog-title">Phil Sturgeon</h1>
        <h2 class="blog-description">I used to contribute to the PHP-FIG, The League of Extraordinary Packages, PHP The Right Way, CodeIgniter, FuelPHP, PyroCMS and a bunch of other stuff, but I gave it all up to join the circus</h2>
        <a href="/" class="btn">Back to Overview</a>
      </div>
    </div>

    <!-- content end -->

    <footer class='footer' role='contentinfo'>
  <div class='footer-links'>
    <ul class='context'>
      <li>
        <h3>Content</h3>
      </li>
      <li>
        <a href='/about'>About</a>
      </li>
      <li>
        <a href='/books'>Books</a>
      </li>
    </ul>
    <ul class='follow'>
      <li>
        <h3>Follow Me</h3>
      </li>
      <li>
        <a href='https://twitter.com/philsturgeon'>Twitter</a>
      </li>
      <li>
        <a href='https://github.com/'>GitHub</a>
      </li>
      <li>
        <a href='http://phptownhall.com/'>PHP Town Hall</a>
      </li>
    </ul>
    <ul class='recent_posts'>
      <li>
        <h3>Recent Posts</h3>
        <ul>
          <li><a href="/http/2015/09/03/auto-incrementing-to-destruction/">Auto-Incrementing IDs: Giving your Data Away</a></li>
          <li><a href="/charity/2015/08/20/no-booze/">No Booze for a Month</a></li>
          <li><a href="/feminism/2015/08/17/women-speaker-ratio-conversation-loop/">The Ratio of Women Speakers in Tech</a></li>
        </ul>
      </li>
    </ul>
  </div>
</footer>

    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="/javascripts/jquery.fitvids.js"></script>
<script src="/javascripts/index.js"></script>
<script src="/javascripts/readingTime.min.js"></script>
<script>
(function ($) {
  "use strict";
  $(document).ready(function(){

    var $window = $(window),
    $image = $('.post-image-image, .teaserimage-image');
    $window.on('scroll', function() {
      var top = $window.scrollTop();

      if (top < 0 || top > 1500) { return; }
      $image
        .css('transform', 'translate3d(0px, '+top/3+'px, 0px)')
        .css('opacity', 1-Math.max(top/700, 0));
    });
    $window.trigger('scroll');

    var height = $('.article-image').height();
    $('.post-content').css('padding-top', height + 'px');

    $('a[href*=#]:not([href=#])').click(function() {
      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'')
       && location.hostname == this.hostname) {
        var target = $(this.hash);
        target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
        if (target.length) {
          $('html,body').animate({ scrollTop: target.offset().top }, 500);
          return false;
        }
      }
    });
  });
}(jQuery));
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8523256-1', 'auto');
  ga('send', 'pageview');

</script>


  </body>

</html>
